# "네모 안으로 던지기" 연구 설계

## 📋 연구 배경

### 팬들의 외침: "네모 안으로 던져!"
KBO 야구팬들이 투수들에게 자주 하는 말로, 투수들이 스트라이크 존("네모")으로 공을 제대로 던지지 못한다는 불만을 담고 있음.

### 연구 목적
1. **"네모 안으로 던지기"의 난이도 정량화**
2. **엘리트 vs 비엘리트 투수의 제구력 차이** 측정
3. **상황별 제구력 변화** 분석 (압박 상황에서 얼마나 어려워지는가?)

---

## 🎯 핵심 연구 질문

### Q1. 네모 안으로 던지는 것은 정말 어려운가?
- KBO 투수들의 평균 스트라이크 존 명중률은?
- 구종별, 카운트별 차이는?

### Q2. 엘리트 투수와 일반 투수의 차이는?
- 상위 10% vs 하위 10% 투수의 제구력 격차는?
- 제구력이 성적(ERA, WHIP 등)과 상관관계는?

### Q3. 상황에 따라 난이도가 변하는가?
- **주자 상황**: 주자 없음 vs 득점권 주자 있음
- **레버리지**: 낮은 압박 vs 높은 압박 상황
- **카운트**: 유리한 카운트 vs 불리한 카운트

---

## 📊 지표 정의

### 1. 스트라이크 존 정의

#### Heart Zone (핵심 스트라이크 존)
- **Baseball Savant Zone 1-9**
- 타자가 가장 잘 치는 영역이지만, 명확한 스트라이크
- **정의**: `sz_bot ≤ plate_z ≤ sz_top` AND `|plate_x| ≤ 8.5 inches (0.71 feet)`

#### Shadow Zone (경계 스트라이크 존)
- **Baseball Savant Zone 11-19**
- 스트라이크 존 경계 ± 3.3" (좌우), ± 4" (상하)
- 심판 판정에 따라 스트라이크/볼 갈림

#### All Strike Zone (전체 스트라이크 존)
- Heart + Shadow 합계
- 심판이 스트라이크로 판정 가능한 전체 영역

### 2. 제구 지표

#### Strike Zone Command% (스트라이크 존 명중률)
```
SZ Command% = (스트라이크 존 내 투구 / 전체 투구) × 100
```

#### Heart Zone Command% (핵심 존 명중률)
```
Heart Command% = (Heart Zone 내 투구 / 전체 투구) × 100
```

#### Shadow Zone Command% (경계 존 명중률)
```
Shadow Command% = (Shadow Zone 내 투구 / 전체 투구) × 100
```

#### Waste Zone % (헛구역 비율)
```
Waste% = (Waste Zone 투구 / 전체 투구) × 100
```
- Waste Zone: `plate_z < (sz_bot - 1.0) OR plate_z > (sz_top + 1.0)`

#### First Pitch Strike% (초구 스트라이크 비율)
```
FPS% = (0-0 카운트 스트라이크 / 0-0 카운트 투구) × 100
```

---

## 🔍 분석 차원

### 1. 구종별 분석

#### 주요 구종
- **패스트볼 그룹**: 직구, 투심, 싱커
- **브레이킹볼 그룹**: 커브, 슬라이더, 스위퍼
- **오프스피드 그룹**: 체인지업, 포크
- **기타**: 커터

#### 분석 이유
- 직구/투심은 **주무기**로 제구가 가장 중요
- 변화구는 스트라이크 존 밖으로 유도하는 목적도 있음

### 2. 카운트별 분석

#### 투수 유리 카운트
- 0-2, 1-2: 2스트라이크 후
- 0-0, 0-1: 초구, 2구째

#### 타자 유리 카운트
- 3-0, 3-1, 2-0: 볼 카운트 앞섬
- 3-2: 풀카운트

#### 분석 목적
- 압박 상황에서 제구력 저하 확인

### 3. 주자 상황별 분석

#### 주자 없음
- `runners_on_base = 0`
- 압박 최소

#### 주자 있음 (득점권 아님)
- `start_base1_pcode IS NOT NULL` (1루만)
- 중간 압박

#### 득점권 주자
- `start_base2_pcode IS NOT NULL OR start_base3_pcode IS NOT NULL`
- 높은 압박

### 4. 레버리지 상황별 분석

#### 낮은 압박 (Low Leverage)
- `leverage_index < 1.0`
- 점수 차 크거나, 이닝 초반

#### 중간 압박 (Medium Leverage)
- `1.0 ≤ leverage_index < 2.0`

#### 높은 압박 (High Leverage)
- `leverage_index ≥ 2.0`
- 점수 접전, 후반 이닝, 득점권 주자

---

## 📈 분석 방법론

### 1. 기술 통계
- 각 지표의 평균, 중앙값, 표준편차
- 백분위수 (10th, 25th, 50th, 75th, 90th)

### 2. 비교 분석
- **엘리트 (상위 10%) vs 비엘리트 (하위 10%)**
  - ERA 기준 상위/하위 10%
  - SZ Command% 기준 상위/하위 10%
- **구종별 비교**
- **상황별 비교** (주자 유무, 레버리지)

### 3. 상관 분석
- SZ Command% ↔ ERA
- SZ Command% ↔ WHIP
- SZ Command% ↔ K/9

### 4. 회귀 분석
- 제구력이 성적에 미치는 영향
- 상황 변수(주자, 레버리지)가 제구력에 미치는 영향

---

## 💾 데이터 요구사항

### 사용 가능 데이터 (확인 완료)
✅ `pitches` 테이블:
- `plate_x`, `plate_z`: 투구 위치
- `sz_top`, `sz_bot`: 스트라이크 존 경계
- `pitch_type`: 구종
- `balls_before`, `strikes_before`: 카운트

✅ `plate_appearances` 테이블:
- `leverage_index`: 레버리지 지수
- `start_base1_pcode`, `start_base2_pcode`, `start_base3_pcode`: 주자 상황
- `runners_on_base`: 주자 수
- `start_outs`: 아웃카운트

### 추가 필요 데이터
- 투수별 시즌 성적 (ERA, WHIP, K/9 등) → `players` 또는 집계 필요

---

## 🎯 예상 연구 결과

### 가설 1: 네모 안으로 던지기는 어렵다
- **예상**: KBO 평균 SZ Command% < 50%
- **근거**: MLB 평균도 40-45% 수준

### 가설 2: 엘리트 투수는 제구력이 압도적
- **예상**: 상위 10% SZ Command% > 55%, 하위 10% < 40%
- **격차**: 15%p 이상

### 가설 3: 압박 상황에서 제구력 저하
- **예상**:
  - 득점권 주자 있을 때: -5%p
  - High Leverage: -3%p
  - 불리한 카운트: -7%p

### 가설 4: 직구/투심 제구가 핵심
- **예상**: 패스트볼 SZ Command%가 ERA와 강한 음의 상관 (r < -0.6)

---

## 📋 연구 산출물

### 1. 데이터 파일
- `pitcher_command_stats.csv`: 투수별 제구 지표
- `pitch_type_command.csv`: 구종별 제구 지표
- `situation_command.csv`: 상황별 제구 지표
- `elite_vs_regular.csv`: 엘리트 vs 일반 투수 비교

### 2. 시각화
- 제구력 분포 히스토그램
- 구종별 스트라이크 존 히트맵
- 상황별 제구력 변화 그래프
- 엘리트 vs 비엘리트 비교 차트

### 3. 보고서
- `STRIKE_ZONE_COMMAND_REPORT.md`: 종합 보고서
- `DIFFICULTY_ANALYSIS.md`: 난이도 분석
- `ELITE_COMPARISON.md`: 엘리트 분석

---

## ⚠️ 연구 제약 및 고려사항

### 1. 데이터 품질
- `plate_x`, `plate_z` NULL 값 존재 가능
- Tracking 데이터 정확도 이슈

### 2. 표본 크기
- 분석 대상: 2025 시즌 500구 이상 투수
- 구종별 분석 시 샘플 부족 가능

### 3. 해석 주의사항
- **스트라이크 존 = 좋은 투구 아님**
  - Heart Zone은 타자가 가장 잘 침
  - Chase Zone (존 밖 헛스윙 유도)도 중요 전략
- **제구 ≠ 실력 전부**
  - 구위, 구속, 배합 등도 중요

---

## 🚀 단계별 실행 계획

### Phase 1: 파일럿 분석 (현재)
- [ ] 데이터 스키마 확인 ✅
- [ ] 연구 설계 문서 작성 ✅
- [ ] 파일럿 쿼리 작성 및 테스트
- [ ] 소규모 샘플로 지표 계산
- [ ] 사용자 피드백 및 연구 방향 확정

### Phase 2: 본 분석
- [ ] 전체 투수 제구 지표 계산
- [ ] 구종별 분석
- [ ] 상황별 분석 (주자, 레버리지, 카운트)
- [ ] 엘리트 vs 비엘리트 비교

### Phase 3: 시각화 및 보고서
- [ ] 차트 생성
- [ ] 종합 보고서 작성
- [ ] 결과 해석 및 인사이트 도출

---

**다음 단계**: 파일럿 분석 스크립트 작성 및 실행 대기
**사용자 승인 필요**: 연구 방향, 지표 정의, 분석 범위
